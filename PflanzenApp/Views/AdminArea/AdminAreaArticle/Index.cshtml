@model GardifyModels.Models.ArticleViewModels.ArticleListViewModel
@{
    ViewBag.Title = "Alle Artikel";
    Layout = "~/Views/Shared/_LayoutAdminArea.cshtml";
}
@if (Model.StatusMessage != null)
{
	Html.RenderPartial("_modalStatusMessage", Model.StatusMessage);
}
<h2>Alle Artikel</h2>
<p>
	@Html.ActionLink("Neuer Artikel", "Create")
</p>
<div class="articles-wrapper">
	<div class="form-horizontal">
		<div class="form-group">
			<label class="control-label col-sm-3">Kategorie auswahl</label>
			<div class="col-sm-9">
				@Html.DropDownListFor(model => model.SelectedCategoriesId, new SelectList(Model.CategoriesEntries, "Value", "Text", Model.SelectedCategoriesId), new { @class = "form-control", @style = "display:inline-block", @onchange = "changeArticleCategory(this.value)" })
				
			</div>
		</div>
	</div>
	@if (Model.ListEntries != null && Model.ListEntries.Any())
    {
        foreach (var entry in Model.ListEntries.Select((value, i) => new { i, value }))
        {
            var item = entry.value;
            var index = entry.i;
			<div class="row">
				@if (item.ArticleImages != null && item.ArticleImages.Any())
                {
					<div class="image-wrapper col-md-3">
						<div class="title-image">
							<img title="@item.ArticleImages.FirstOrDefault().TitleAttr" src="@item.ArticleImages.FirstOrDefault().SrcAttr" alt="@item.ArticleImages.FirstOrDefault().AltAttr" />
						</div>
						@foreach (var img in item.ArticleImages.Skip(1))
                        {
							<div class="thumbnail col-md-4">
								<img title="@img.TitleAttr" src="@img.SrcAttr" alt="@img.AltAttr" />
							</div>
                        }
					</div>
                }
            <div class="col-md-9">
                <h3>@Html.ActionLink(item.Name, "Edit", new { id = item.Id }, new { style = "color: #000" })</h3>
                @if (item.Description.Length > 228)
                {
                    @(item.Description.Substring(0, 228) + " ...")
                }
                else
                {
                    @item.Description
                }
                <hr />
                <b>Preis: @item.NormalPrice€</b><br />
                <b>Prozent bezahlbar mit Punkten: @item.PricePercentagePayableWithPoints%</b><br />
                <b>Punkte: @item.PointsToSpend</b><br />
                <b>Ersparnis: @item.PointsValue€</b><br />
                <b>Rest zu zahlen: @item.PricePartAfterPoints€</b><br />
                <b>Veröffentlicht: @{if (item.AllowPublishment)
                    {<span>Ja</span>}
                    else
                    {<span>Nein</span>}
                    }
                </b>
            </div>
			</div>
			<div class="row">
				<div class="col-xs-3 col-md-push-4">
					<hr />
					@Html.ActionLink("ändern", "Edit", new { id = item.Id }, new { style = "float: right; margin: 0 20px 0 0;", @class = "btn btn-default" })
				</div>
			</div>

			<hr />
		}
	}
	else
	{
		<p>Keine Artikel gefunden</p>
	}
</div>